!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=function(n,o){return void 0===o&&(o="undefined"!=typeof window?require("jquery"):require("jquery")(n)),t(o),o}:t(jQuery)}(function(t){"use strict";var n=0;t.fn.TouchSpin=function(o){var s={min:0,max:100,initval:"",replacementval:"",firstclickvalueifempty:null,step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"-",verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"-",buttonup_txt:"+",callback_before_calculation:function(t){return t},callback_after_calculation:function(t){return t}},a={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",firstclickvalueifempty:"first-click-value-if-empty",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){var p,e,i,u,r,c,l,d,f,b,h="input[name="+t(this).attr("name")+"]",v=t(this),x=v.data(),m=0,g=!1;function w(){""===p.prefix&&(e=r.prefix.detach()),""===p.postfix&&(i=r.postfix.detach())}function _(){var t,n,o;""!==(t=p.callback_before_calculation(v.val()))?p.decimals>0&&"."===t||(n=parseFloat(t),isNaN(n)&&(n=""!==p.replacementval?p.replacementval:0),o=n,n.toString()!==t&&(o=n),null!==p.min&&n<p.min&&(o=p.min),null!==p.max&&n>p.max&&(o=p.max),o=function(t){switch(p.forcestepdivisibility){case"round":return(Math.round(t/p.step)*p.step).toFixed(p.decimals);case"floor":return(Math.floor(t/p.step)*p.step).toFixed(p.decimals);case"ceil":return(Math.ceil(t/p.step)*p.step).toFixed(p.decimals);default:return t.toFixed(p.decimals)}}(o),Number(t).toString()!==o.toString()&&(v.val(o),v.trigger("change"))):""!==p.replacementval&&(v.val(p.replacementval),v.trigger("change"))}function y(){if(p.booster){var t=Math.pow(2,Math.floor(m/p.boostat))*p.step;return p.maxboostedstep&&t>p.maxboostedstep&&(t=p.maxboostedstep,c=Math.round(c/t)*t),Math.max(p.step,t)}return p.step}function k(){return"number"==typeof p.firstclickvalueifempty?p.firstclickvalueifempty:(p.min+p.max)/2}function C(){_();var t,n=c=parseFloat(p.callback_before_calculation(r.input.val()));isNaN(c)?c=k():(t=y(),c+=t),null!==p.max&&c>p.max&&(c=p.max,v.trigger("touchspin.on.max"),F()),r.input.val(p.callback_after_calculation(Number(c).toFixed(p.decimals))),n!==c&&v.trigger("change")}function j(){_();var t,n=c=parseFloat(p.callback_before_calculation(r.input.val()));isNaN(c)?c=k():(t=y(),c-=t),null!==p.min&&c<p.min&&(c=p.min,v.trigger("touchspin.on.min"),F()),r.input.val(p.callback_after_calculation(Number(c).toFixed(p.decimals))),n!==c&&v.trigger("change")}function D(){F(),m=0,g="down",v.trigger("touchspin.on.startspin"),v.trigger("touchspin.on.startdownspin"),f=setTimeout(function(){l=setInterval(function(){m++,j()},p.stepinterval)},p.stepintervaldelay)}function N(){F(),m=0,g="up",v.trigger("touchspin.on.startspin"),v.trigger("touchspin.on.startupspin"),b=setTimeout(function(){d=setInterval(function(){m++,C()},p.stepinterval)},p.stepintervaldelay)}function F(){switch(clearTimeout(f),clearTimeout(b),clearInterval(l),clearInterval(d),g){case"up":v.trigger("touchspin.on.stopupspin"),v.trigger("touchspin.on.stopspin");break;case"down":v.trigger("touchspin.on.stopdownspin"),v.trigger("touchspin.on.stopspin")}m=0,g=!1}!function(){if(v.data("alreadyinitialized"))return;if(v.data("alreadyinitialized",!0),n+=1,v.data("spinnerid",n),!v.is("input"))return void console.log("Must be an input.");p=t.extend({},s,x,(c={},t.each(a,function(t,n){var o="bts-"+n;v.is("[data-"+o+"]")&&(c[t]=v.data(o))}),c),o),""!==p.initval&&""===v.val()&&v.val(p.initval),_(),function(){var n=v.val(),o=v.parent();""!==n&&(n=p.callback_after_calculation(Number(n).toFixed(p.decimals)));v.data("initvalue",n).val(n),v.addClass("form-control"),o.hasClass("input-group")?function(n){n.addClass("bootstrap-touchspin");var o,s,a=v.prev(),e=v.next(),i='<span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix input-group-prepend bootstrap-touchspin-injected"><span class="input-group-text">'+p.prefix+"</span></span>",r='<span class="input-group-addon input-group-append bootstrap-touchspin-postfix input-group-append bootstrap-touchspin-injected"><span class="input-group-text">'+p.postfix+"</span></span>";a.hasClass("input-group-btn")||a.hasClass("input-group-prepend")?(o='<button class="'+p.buttondown_class+' bootstrap-touchspin-down bootstrap-touchspin-injected" type="button">'+p.buttondown_txt+"</button>",a.append(o)):(o='<span class="input-group-btn input-group-prepend bootstrap-touchspin-injected"><button class="'+p.buttondown_class+' bootstrap-touchspin-down" type="button">'+p.buttondown_txt+"</button></span>",t(o).insertBefore(v));e.hasClass("input-group-btn")||e.hasClass("input-group-append")?(s='<button class="'+p.buttonup_class+' bootstrap-touchspin-up bootstrap-touchspin-injected" type="button">'+p.buttonup_txt+"</button>",e.prepend(s)):(s='<span class="input-group-btn input-group-append bootstrap-touchspin-injected"><button class="'+p.buttonup_class+' bootstrap-touchspin-up" type="button">'+p.buttonup_txt+"</button></span>",t(s).insertAfter(v));t(i).insertBefore(v),t(r).insertAfter(v),u=n}(o):function(){var n,o="";v.hasClass("input-sm")&&(o="input-group-sm");v.hasClass("input-lg")&&(o="input-group-lg");n=p.verticalbuttons?'<div class="input-group '+o+' bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix"><span class="input-group-text">'+p.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+p.postfix+'</span></span><span class="input-group-btn-vertical"><button class="'+p.buttondown_class+" bootstrap-touchspin-up "+p.verticalupclass+'" type="button">'+p.verticalup+'</button><button class="'+p.buttonup_class+" bootstrap-touchspin-down "+p.verticaldownclass+'" type="button">'+p.verticaldown+"</button></span></div>":'<div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-btn input-group-prepend"><button class="'+p.buttondown_class+' bootstrap-touchspin-down" type="button">'+p.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"><span class="input-group-text">'+p.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+p.postfix+'</span></span><span class="input-group-btn input-group-append"><button class="'+p.buttonup_class+' bootstrap-touchspin-up" type="button">'+p.buttonup_txt+"</button></span></div>";u=t(n).insertBefore(v),t(".bootstrap-touchspin-prefix",u).after(v),v.hasClass("input-sm")?u.addClass("input-group-sm"):v.hasClass("input-lg")&&u.addClass("input-group-lg")}()}(),r={down:t(".bootstrap-touchspin-down",u),up:t(".bootstrap-touchspin-up",u),input:t(h,u),prefix:t(".bootstrap-touchspin-prefix",u).addClass(p.prefix_extraclass),postfix:t(".bootstrap-touchspin-postfix",u).addClass(p.postfix_extraclass)},w(),v.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;38===n?("up"!==g&&(C(),N()),t.preventDefault()):40===n&&("down"!==g&&(j(),D()),t.preventDefault())}),v.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;38===n?F():40===n&&F()}),v.on("blur.touchspin",function(){_(),v.val(p.callback_after_calculation(v.val()))}),r.down.on("keydown",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("down"!==g&&(j(),D()),t.preventDefault())}),r.down.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||F()}),r.up.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("up"!==g&&(C(),N()),t.preventDefault())}),r.up.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||F()}),r.down.on("mousedown.touchspin",function(t){r.down.off("touchstart.touchspin"),v.is(":disabled")||(j(),D(),t.preventDefault(),t.stopPropagation())}),r.down.on("touchstart.touchspin",function(t){r.down.off("mousedown.touchspin"),v.is(":disabled")||(j(),D(),t.preventDefault(),t.stopPropagation())}),r.up.on("mousedown.touchspin",function(t){r.up.off("touchstart.touchspin"),v.is(":disabled")||(C(),N(),t.preventDefault(),t.stopPropagation())}),r.up.on("touchstart.touchspin",function(t){r.up.off("mousedown.touchspin"),v.is(":disabled")||(C(),N(),t.preventDefault(),t.stopPropagation())}),r.up.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){g&&(t.stopPropagation(),F())}),r.down.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){g&&(t.stopPropagation(),F())}),r.down.on("mousemove.touchspin touchmove.touchspin",function(t){g&&(t.stopPropagation(),t.preventDefault())}),r.up.on("mousemove.touchspin touchmove.touchspin",function(t){g&&(t.stopPropagation(),t.preventDefault())}),v.on("mousewheel.touchspin DOMMouseScroll.touchspin",function(t){if(p.mousewheel&&v.is(":focus")){var n=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),n<0?j():C()}}),v.on("touchspin.destroy",function(){var n;n=v.parent(),F(),v.off(".touchspin"),n.hasClass("bootstrap-touchspin-injected")?(v.siblings().remove(),v.unwrap()):(t(".bootstrap-touchspin-injected",n).remove(),n.removeClass("bootstrap-touchspin")),v.data("alreadyinitialized",!1)}),v.on("touchspin.uponce",function(){F(),C()}),v.on("touchspin.downonce",function(){F(),j()}),v.on("touchspin.startupspin",function(){N()}),v.on("touchspin.startdownspin",function(){D()}),v.on("touchspin.stopspin",function(){F()}),v.on("touchspin.updatesettings",function(n,o){!function(n){(function(n){if(p=t.extend({},p,n),n.postfix){var o=v.parent().find(".bootstrap-touchspin-postfix");0===o.length&&i.insertAfter(v),v.parent().find(".bootstrap-touchspin-postfix .input-group-text").text(n.postfix)}if(n.prefix){var s=v.parent().find(".bootstrap-touchspin-prefix");0===s.length&&e.insertBefore(v),v.parent().find(".bootstrap-touchspin-prefix .input-group-text").text(n.prefix)}w()})(n),_();var o=r.input.val();""!==o&&(o=Number(p.callback_before_calculation(r.input.val())),r.input.val(p.callback_after_calculation(Number(o).toFixed(p.decimals))))}(o)});var c}()})}});
