function phRemoveUrlParameter(e,a){var r=a.split("?")[0],i=[],a=-1!==a.indexOf("?")?a.split("?")[1]:"";if(""!==a){for(var t=(i=a.split("&")).length-1;0<=t;--t)paramV=i[t].split("=")[0],paramV===e&&i.splice(t,1);r=r+"?"+i.join("&")}return r}function startOverlay(e){jQuery('<div id="phOverlayDiv"><div id="phLoaderFull"> </div></div>').appendTo(e),jQuery("#phOverlayDiv").fadeIn().css("display","block")}function startFullOverlay(e){2==e||(jQuery('<div id="phOverlay"><div id="phLoaderFull"> </div></div>').appendTo(document.body),jQuery("#phOverlay").fadeIn().css("display","block"))}function stopOverlay(){jQuery("#phOverlay").fadeIn().css("display","none")}function phRemoveParamFromUrl(e,a){var r=a.split("?")[0],i=[],a=-1!==a.indexOf("?")?a.split("?")[1]:"";if(""!==a){for(var t=(i=a.split("&")).length-1;0<=t;--t)i[t].split("=")[0]===e&&i.splice(t,1);r=r+"?"+i.join("&")}return r}function phUpdatePageAndParts(e,a){var r,i=Joomla.getOptions("phVarsPC"),t=Joomla.getOptions("phParamsModPhocacartSearch"),o="/";"undefined"!=i.basePath&&""!=i.basePath||(o=""),""==e?window.history.pushState({},"",location.pathname):window.history.pushState({},"",e),r=""!=e?(r=phRemoveParamFromUrl("format",e),e+"&format=raw"):"?format=raw";var p=phRemoveParamFromUrl("option",r),p=phRemoveParamFromUrl("view",p);p=(p=phRemoveParamFromUrl("module",p)).substring(p.indexOf("?")+1);e=i.basePath+o+"index.php?option=com_ajax&module=phocacart_search",o=i.basePath+o+"index.php?option=com_ajax&module=phocacart_filter";0==p.indexOf("?")?(e=e+"&"+p.substr(1),o=o+"&"+p.substr(1)):0==p.indexOf("&")?(e+=p,o+=p):(e=e+"&"+p,o=o+"&"+p),void 0!==t&&1==i.mod_phocacart_search&&1==t.displayActiveParameters&&phRenderPagePart({},"phSearchActiveTags",e),void 0!==i&&1==i.mod_phocacart_filter&&2==a&&phRenderPagePart({},"phFilterBox",o),phRenderPage({},r)}function phRenderPage(e,a){var r=Joomla.getOptions("phVarsPC"),i=Joomla.getOptions("phParamsPC"),t="#"+r.renderPageOutput,o=r.renderPageUrl,p=r.isPOS,n=i.loadChosen;return startOverlay(t),o=void 0!==a?a:o,phRequest=jQuery.ajax({type:"POST",url:o,async:!0,cache:"false",data:e,dataType:"HTML",success:function(e){jQuery(t).html(e),1==p&&phPosManagePage(),1==n&&jQuery("select").chosen("destroy").chosen({disable_search_threshold:10,allow_single_deselect:!0}),"function"==typeof phChangeAttributeType&&phChangeAttributeType(),"undefined"!=typeof phLazyLoadInstance&&phLazyLoadInstance&&phLazyLoadInstance.update(),stopOverlay()}}),!1}function phRenderPagePart(e,a,r){phRequest=jQuery.ajax({type:"POST",url:r,async:!0,cache:"false",data:e,dataType:"HTML",success:function(e){a="#"+a,jQuery(a).html(e)}})}function phDisableRequirement(){var e=Joomla.getOptions("phParamsPC").loadChosen,a=jQuery("#jform_country_phs"),r=jQuery("#jform_region_phs");jQuery("#phCheckoutBillingSameAsShipping").prop("checked")?(jQuery(".phShippingFormFields").prop("readonly",!0),a.attr("disabled","disabled"),r.attr("disabled","disabled"),jQuery(".phShippingFormFieldsRequired").removeAttr("aria-required"),jQuery(".phShippingFormFieldsRequired").removeAttr("required"),0<e&&(jQuery(".phShippingFormFieldsRequired").trigger("chosen:updated"),jQuery(".phShippingFormFields").trigger("chosen:updated")),jQuery("#phShippingAddress").addClass("ph-disabled")):(jQuery(".phShippingFormFieldsRequired").prop("aria-required","true"),jQuery(".phShippingFormFieldsRequired").prop("required","true"),jQuery(".phShippingFormFields").removeAttr("readonly"),a.removeAttr("disabled"),r.removeAttr("disabled"),0<e&&(jQuery(".phShippingFormFieldsRequired").trigger("chosen:updated"),jQuery(".phShippingFormFields").trigger("chosen:updated")),jQuery("#phShippingAddress").removeClass("ph-disabled"))}function phRenderBillingAndShippingSame(){phDisableRequirement(),jQuery("#phCheckoutBillingSameAsShipping").on("click",function(){phDisableRequirement()})}function phEventChangeFormPagination(e,a){var r=Joomla.getOptions("phVarsPC"),i=Joomla.getOptions("phParamsPC"),t=jQuery(a).val(),a="#"+jQuery(a).attr("id")+"top";jQuery(a).val(t);t=jQuery(e).attr("name");1==i.ajaxPaginationCategory||1==r.isPOS||"phitemstopboxform"==t?(t=window.location.href,phRenderPage(jQuery(e).serialize(),t)):(e.submit(),startFullOverlay(1))}function phNumberFormat(e,a,r,i){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var t,o,p,n=isFinite(+e)?+e:0,e=isFinite(+a)?Math.abs(a):0,a=void 0===i?",":i,i=void 0===r?".":r,r="";return 3<(r=(e?(t=n,o=e,p=Math.pow(10,o),""+(Math.round(t*p)/p).toFixed(o)):""+Math.round(n)).split("."))[0].length&&(r[0]=r[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,a)),(r[1]||"").length<e&&(r[1]=r[1]||"",r[1]+=new Array(e-r[1].length+1).join("0")),r.join(i)}jQuery(document).ready(function(){jQuery(".phItemSwitchLayoutType").on("click",function(e){var a=jQuery(this).data("layouttype"),r=jQuery(this).closest("form").serialize()+"&layouttype="+a;jQuery(".phItemSwitchLayoutType").removeClass("active"),jQuery(".phItemSwitchLayoutType."+a).addClass("active"),phRenderPage(r,window.location.href)}),jQuery(document).on("click",".phPaginationBox .pagination li a",function(e){var a=Joomla.getOptions("phVarsPC");1!=Joomla.getOptions("phParamsPC").ajaxPaginationCategory&&1!=a.isPOS||(a=jQuery(this).attr("href"),phRenderPage(jQuery(this).closest("form").serialize(),a),a=phRemoveUrlParameter("format",a),a=phRemoveUrlParameter("start",a),window.history.pushState("","",a),e.preventDefault())}),phRenderBillingAndShippingSame()});